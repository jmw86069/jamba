<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Import one or more data.frame from Excel xlsx format — readOpenxlsx • jamba</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import one or more data.frame from Excel xlsx format — readOpenxlsx"><meta name="description" content="Import one or more data.frame from Excel xlsx format"><meta property="og:description" content="Import one or more data.frame from Excel xlsx format"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">jamba</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/jamba-vignette.html">Jamba Overview</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jmw86069/jamba/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Import one or more data.frame from Excel xlsx format</h1>
      <small class="dont-index">Source: <a href="https://github.com/jmw86069/jamba/blob/HEAD/R/jamba-export.r" class="external-link"><code>R/jamba-export.r</code></a></small>
      <div class="d-none name"><code>readOpenxlsx.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Import one or more data.frame from Excel xlsx format</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">readOpenxlsx</span><span class="op">(</span></span>
<span>  <span class="va">xlsx</span>,</span>
<span>  sheet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  startRow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  startCol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_header <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_header_n <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-xlsx">xlsx<a class="anchor" aria-label="anchor" href="#arg-xlsx"></a></dt>
<dd><p><code>character</code> path to an Excel file in <code>xlsx</code> format,
compatible with <code><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">openxlsx::read.xlsx()</a></code>.</p></dd>


<dt id="arg-sheet">sheet<a class="anchor" aria-label="anchor" href="#arg-sheet"></a></dt>
<dd><p>one of <code>NULL</code>, <code>character</code>, or <code>integer</code> vector,
where: <code>sheet=NULL</code> will import every sheet; <code>character</code> is
a vector of sheet names; and <code>integer</code> is a vector of sheet
index values. The sheet names are determined with
<code><a href="https://rdrr.io/pkg/openxlsx/man/getSheetNames.html" class="external-link">openxlsx::getSheetNames()</a></code>.</p></dd>


<dt id="arg-startrow">startRow<a class="anchor" aria-label="anchor" href="#arg-startrow"></a></dt>
<dd><p><code>integer</code> indicating the row number to start
importing each <code>sheet</code>.</p><ul><li><p>Note <code>startRow</code> can be a vector
with length <code>length(sheet)</code>, to specify the <code>startRow</code> for
each <code>sheet</code>.</p></li>
<li><p>Note <code>startRow</code> is ignored when <code>rows</code> is defined for the same sheet,
to minimize confusion about using both togetheer.</p></li>
</ul></dd>


<dt id="arg-startcol">startCol<a class="anchor" aria-label="anchor" href="#arg-startcol"></a></dt>
<dd><p><code>integer</code> indicating the first column number to retain
after importing each <code>sheet</code>.</p><ul><li><p>Note <code>startCol</code> can be a vector with length <code>length(sheet)</code>,
to specify the <code>startCol</code> for each <code>sheet</code>.</p></li>
<li><p>Note <code>startCol</code> is ignored when <code>cols</code> is defined for the same sheet,
to minimize confusion about using both togetheer.</p></li>
</ul></dd>


<dt id="arg-rows">rows<a class="anchor" aria-label="anchor" href="#arg-rows"></a></dt>
<dd><p><code>integer</code> vector indicating specific rows to import
for each <code>sheet</code>.</p><ul><li><p>To specify different <code>rows</code> for each <code>sheet</code>,
supply <code>rows</code> as a <code>list</code> of <code>integer</code> vectors.</p></li>
<li><p>Note that when <code>rows</code> is defined for a sheet, it will be used
and <code>startRow</code> will be ignored for that same sheet.</p></li>
</ul></dd>


<dt id="arg-cols">cols<a class="anchor" aria-label="anchor" href="#arg-cols"></a></dt>
<dd><p><code>integer</code> vector indicating specific column numbers to import
for each <code>sheet</code>.</p><ul><li><p>To specify different <code>cols</code> for each <code>sheet</code>, supply <code>cols</code>
as a <code>list</code> of <code>integer</code> vectors.</p></li>
<li><p>Note that when <code>cols</code> is defined for a sheet, it will be used
and <code>startCol</code> will be ignored for that same sheet.</p></li>
</ul></dd>


<dt id="arg-check-names">check.names<a class="anchor" aria-label="anchor" href="#arg-check-names"></a></dt>
<dd><p><code>logical</code> indicating whether to call <code><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names()</a></code>
on the <code>colnames</code> of each <code>data.frame</code>.</p><ul><li><p>Note that <code><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">openxlsx::read.xlsx()</a></code> does not honor <code>check.names=FALSE</code>,
so a workaround is applied which loads a single line
without column headers, in order to obtain the same data without
mangling column headers. If this process fails, another workaround
is to use <code>startRow=2</code> (one higher than previous) and <code>colNames=FALSE</code>.</p></li>
</ul></dd>


<dt id="arg-check-header">check_header<a class="anchor" aria-label="anchor" href="#arg-check-header"></a></dt>
<dd><p><code>logical</code> indicating whether to test for presence
of header rows, which may be multi-line column headers.
When <code>check_header=TRUE</code>, this
method simply tests for the presence of rows that have <code>ncol</code>
different than the remaining rows of data in the given sheet.
When header rows are detected, the values are assigned to column
<code>dimnames</code> of the <code>data.frame</code>.</p></dd>


<dt id="arg-check-header-n">check_header_n<a class="anchor" aria-label="anchor" href="#arg-check-header-n"></a></dt>
<dd><p><code>integer</code> number of rows to test for header rows,
only used when <code>check_header=TRUE</code>. This step is intended when
the top row(s) contain fewer columns with headers, above actual
column headers, for example the first row <code>c("Sample", "", "", "Lane", "")</code>,
and the second row <code>c("Name", "Type", "Label", "Name", "Type")</code>.
In this case the desired output is
<code>"Sample_Name","Sample_Type","Sample_Label","Lane_Name","Lane_Type")</code>.
This option default is <code>FALSE</code> due to the number of exceptions
seen in real data.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments are passed to <code><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">openxlsx::read.xlsx()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>list</code> of <code>data.frame</code> objects, one per sheet in <code>xlsx</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is equivalent to <code><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">openxlsx::read.xlsx()</a></code>
with a few minor additions:</p><ol><li><p>It returns a <code>list</code> of <code>data.frame</code> objects, one per <code>sheet</code>.</p></li>
<li><p>It properly reads the <code>colnames</code> with <code>check.names=FALSE</code>.</p></li>
</ol><p>By default this function returns every <code>sheet</code> for a given
<code>xlsx</code> file.</p>
<p>Some useful details:</p><ul><li><p>Empty columns are not skipped during loading, which means a worksheet
whose data starts at column 3 will be returned with two empty columns,
followed by data from that worksheet. Similarly, any empty columns
in the middle of the data in that worksheet will be included in the
output.</p></li>
<li><p>When both <code>startRow</code> and <code>rows</code> are applied, <code>rows</code> takes priority
and will be used instead of <code>startRows</code>. In fact <code>startRows</code> will be
defined <code>startRows &lt;- min(rows)</code> for each relevant worksheet. However,
for each worksheet either argument can be <code>NULL</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other jam export functions:
<code><a href="applyXlsxCategoricalFormat.html">applyXlsxCategoricalFormat</a>()</code>,
<code><a href="applyXlsxConditionalFormat.html">applyXlsxConditionalFormat</a>()</code>,
<code><a href="set_xlsx_colwidths.html">set_xlsx_colwidths</a>()</code>,
<code><a href="set_xlsx_rowheights.html">set_xlsx_rowheights</a>()</code>,
<code><a href="writeOpenxlsx.html">writeOpenxlsx</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># set up a test data.frame</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">lfc</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="fl">3</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span>;</span></span>
<span class="r-in"><span><span class="va">colorSub</span> <span class="op">&lt;-</span> <span class="fu"><a href="nameVector.html">nameVector</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="rainbow2.html">rainbow2</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name<span class="op">=</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>   int<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   num<span class="op">=</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span><span class="op">-</span><span class="fl">2</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   fold<span class="op">=</span><span class="fl">2</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">lfc</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">lfc</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   lfc<span class="op">=</span><span class="va">lfc</span>,</span></span>
<span class="r-in"><span>   pvalue<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="op">-</span><span class="fl">7</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   hit<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, size<span class="op">=</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">df</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   name   int        num      fold        lfc       pvalue hit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    A     4  0.7349388 -9.106049 -3.1868252 2.780730e-02   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    B    16  5.3131471 -4.218488 -2.0767258 6.122279e-01   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    C    64  9.5543380 -1.395160 -0.4804306 3.146665e-03  -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    D   256 15.2240818  1.016424  0.0235028 1.079898e-06  -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    E  1024 18.3598138  2.060645  1.0430959 5.027544e-05   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    F  4096 22.4007715  5.945047  2.5716883 3.366732e-07   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    G 16384 26.1106827  8.898972  3.1536387 8.554139e-09   1</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>   <span class="va">out_xlsx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"jamba_test.xlsx"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="writeOpenxlsx.html">writeOpenxlsx</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">df</span>,</span></span>
<span class="r-in"><span>      file<span class="op">=</span><span class="va">out_xlsx</span>,</span></span>
<span class="r-in"><span>      sheetName<span class="op">=</span><span class="st">"jamba_test"</span>,</span></span>
<span class="r-in"><span>      colorSub<span class="op">=</span><span class="va">colorSub</span>,</span></span>
<span class="r-in"><span>      intColumns<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>      numColumns<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>      fcColumns<span class="op">=</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>      lfcColumns<span class="op">=</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>      pvalueColumns<span class="op">=</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span>      hitColumn<span class="op">=</span><span class="fl">7</span>,</span></span>
<span class="r-in"><span>      freezePaneRow<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>      freezePaneColumn<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>      append<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>   <span class="co"># now read it back</span></span></span>
<span class="r-in"><span>   <span class="va">df_list</span> <span class="op">&lt;-</span> <span class="fu">readOpenxlsx</span><span class="op">(</span>file<span class="op">=</span><span class="va">out_xlsx</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

