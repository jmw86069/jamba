<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Remove outlier points per row by MAD factor threshold — rowRmMadOutliers • jamba</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Remove outlier points per row by MAD factor threshold — rowRmMadOutliers"><meta property="og:description" content="Remove outlier points per row by MAD factor threshold"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jamba</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.69.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jamba-vignette.html">Jamba Overview</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/jmw86069/jamba/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Remove outlier points per row by MAD factor threshold</h1>
    <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamba/blob/HEAD/R/jamba.r" class="external-link"><code>R/jamba.r</code></a></small>
    <div class="hidden name"><code>rowRmMadOutliers.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Remove outlier points per row by MAD factor threshold</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">rowRmMadOutliers</span><span class="op">(</span>
  <span class="va">x</span>,
  madFactor <span class="op">=</span> <span class="fl">5</span>,
  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,
  minDiff <span class="op">=</span> <span class="fl">0</span>,
  includeAttributes <span class="op">=</span> <span class="cn">FALSE</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>

    <div id="ref-sections">
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>numeric matrix</p></dd>
<dt>madFactor</dt>
<dd><p>numeric value to multiply by each row MAD
to define the threshold for outlier.</p></dd>
<dt>na.rm</dt>
<dd><p>logical indicating whether to ignore NA values
when calculating the MAD value. It should probably always be
<code>TRUE</code>, however setting to <code>FALSE</code> will prevent any
calculations in rows that contain <code>NA</code> values, which could
be useful.</p></dd>
<dt>minDiff</dt>
<dd><p>numeric value indicating the minimum difference
from median to qualify as an outlier. This value protects
against removing outliers which are already extremely
close together.</p></dd>
<dt>includeAttributes</dt>
<dd><p>logical indicating whether to return
attributes that describe the threshold and type of threshold
used per row, in addition to the madFactor and minDiff values
defined.</p></dd>
<dt>verbose</dt>
<dd><p>logical indicating whether to print verbose output.</p></dd>
<dt>...</dt>
<dd><p>additional parameters are ignored.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A numeric matrix is returned, with the same dimensions
as the input <code>x</code> matrix. Outliers are replaced with <code>NA</code>.
If <code>includeAttributes=TRUE</code> then four attributes will be
included as well:</p><dl><dt>attr(x, "rowThresholds")</dt>
<dd><p>The row difference from
median threshold used for filtering.</p></dd>

<dt>attr(out, "rowThresholds")</dt>
<dd><p>When the difference from
median is above <code>minDiff</code> it returns "madFactor",
otherwise it returns "minDiff".</p></dd>

<dt>attr(x, "madFactor")</dt>
<dd><p>The <code>madFactor</code> value used.</p></dd>

<dt>attr(x, "minDiff")</dt>
<dd><p>The <code>minDiff</code> value used.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function applies outlier detection and removal per
row of the input numeric matrix. It first calculates MAD
per row, then defines a cutoff threshold by multiplying the
MAD by the supplied <code>madFactor</code>, and by ensuring the
threshold is at least as large as <code>minDiff</code>.</p>
<p>The <code>minDiff</code> parameter affects cases such as 3 replicates,
where all replicates are well within a known threshold
indicating low variance, but where two replicates might
be nearly identical. Consider <code>c(2.0, 2.0, 2.001)</code>. The
MAD is zero, therefore any difference from median might
otherwise be considered an outlier. One alternative is
to define <code>minDiff &lt;- median(rowMads(x))</code> which sets the
minimum threshold to the median MAD across all rows.
Such a threshold will only be reasonable if the variance
across all rows is expected to be similar.</p>
<p>Note that this function is substantially faster when the
<code>matrixStats</code> package is installed, but will use the
<code>apply(x, 1, mad)</code> format as a last option.</p>
<p>This function assumes the input data is appropriate for
the use of MAD as a summary statistic, specifically that
the numeric values per row are expected to be roughly
normally distributed, with the occassional presence
of outlier points. The outlier points are assumed to be
technical outliers, which are often caused by some
instrument measurement failure or other upstream
protocol failure. A threshold of 5xMAD is fairly lenient
and yet is usually sufficient to identify the most
egregious outliers. Among technical replicates, often
2xMAD is more appropriate.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other jam numeric functions: 
<code><a href="deg2rad.html">deg2rad</a>()</code>,
<code><a href="fix_matrix_ratio.html">fix_matrix_ratio</a>()</code>,
<code><a href="noiseFloor.html">noiseFloor</a>()</code>,
<code><a href="normScale.html">normScale</a>()</code>,
<code><a href="rad2deg.html">rad2deg</a>()</code>,
<code><a href="rowGroupMeans.html">rowGroupMeans</a>()</code>,
<code><a href="warpAroundZero.html">warpAroundZero</a>()</code></p></div>
    </div>
    </div>

    <div id="examples">
    <h2>Examples</h2>
    <div class="ref-examples sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>;</span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">10</span>;</span>
<span class="r-in"><span class="co">## Define some outlier points</span></span>
<span class="r-in"><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">50</span>;</span>
<span class="r-in"><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fl">5</span> <span class="op">-</span> <span class="fl">100</span>;</span>
<span class="r-in"><span class="fu">rowRmMadOutliers</span><span class="op">(</span><span class="va">x</span>, madFactor<span class="op">=</span><span class="fl">5</span><span class="op">)</span>;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]      [,3]       [,4]     [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  7.197622 18.575325        NA 18.9345657 4.660881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  8.849113        NA        NA 12.4892524 8.910125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 17.793542        NA 12.003857  0.1669142 4.869978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 10.352542  6.565736 10.553414 13.5067795 6.355544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 10.646439  7.771690  7.220794  7.6360430 6.874804</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

