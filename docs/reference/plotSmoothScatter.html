<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Smooth scatter plot with enhancements — plotSmoothScatter • jamba</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Smooth scatter plot with enhancements — plotSmoothScatter"><meta property="og:description" content="Produce scatter plot using point density instead of displaying
individual data points."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jamba</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.100.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jamba-vignette.html">Jamba Overview</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/jmw86069/jamba/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Smooth scatter plot with enhancements</h1>
    <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamba/blob/HEAD/R/jamba-plots.r" class="external-link"><code>R/jamba-plots.r</code></a></small>
    <div class="hidden name"><code>plotSmoothScatter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Produce scatter plot using point density instead of displaying
individual data points.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotSmoothScatter</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bwpi <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  binpi <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  bandwidthN <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nbin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.04</span>, <span class="fl">0.04</span><span class="op">)</span>,</span>
<span>  transFactor <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  transformation <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="va">transFactor</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nrpoints <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  colramp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"lightblue"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>, <span class="st">"orangered2"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  doTest <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fillBackground <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  naAction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"remove"</span>, <span class="st">"floor0"</span>, <span class="st">"floor1"</span><span class="op">)</span>,</span>
<span>  xaxt <span class="op">=</span> <span class="st">"s"</span>,</span>
<span>  yaxt <span class="op">=</span> <span class="st">"s"</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  asp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  applyRangeCeiling <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  useRaster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>numeric vector, or data matrix with two or  more columns.</p></dd>


<dt>y</dt>
<dd><p>numeric vector, or if data is supplied via x as a matrix, y
is NULL.</p></dd>


<dt>bwpi</dt>
<dd><p><code>numeric</code> value indicating the bandwidth "per inch"
to scale the bandwidth based upon visual space available.
This argument is used to define <code>bandwidthN</code>, however <code>bwpi</code>
is only used when <code>bandwidthN=NULL</code>.
The bandwidth is used to define the 2-dimensional point density.</p></dd>


<dt>binpi</dt>
<dd><p><code>numeric</code> value indicating the number of bins "per inch",
to scale based upon visual space available.
This argument is used to define <code>nbin</code>, however <code>binpi</code>
is only used when <code>nbin=NULL</code>.</p></dd>


<dt>bandwidthN</dt>
<dd><p><code>integer</code> number of bandwidth steps to use across the
visible plot window. Note that this bandwidth differs from default
<code><a href="https://rdrr.io/r/graphics/smoothScatter.html" class="external-link">graphics::smoothScatter()</a></code> in that it uses the visible
plot window instead of the data range, so if the plot window is not
sufficiently similar to the data range, the resulting smoothed
density will not be visibly distorted. This parameter also permits
display of higher (or lower) level of detail.</p></dd>


<dt>nbin</dt>
<dd><p><code>integer</code> number of bins to use when converting the kernel
density result (which uses bandwidthN above) into a usable image.
This setting is effectively the resolution of rendering the
bandwidth density in terms of visible pixels. For example
<code>nbin=256</code> will create 256 visible pixels wide and tall in each
plot panel; and <code>nbin=32</code> will create 32 visible pixels, with
lower detail which may be suitable for multi-panel plots.
To use a variable number of bins, try <code>binpi</code>.</p></dd>


<dt>expand</dt>
<dd><p><code>numeric</code> value indicating the fraction of the x-axis
and y-axis ranges to add to create an expanded range,
used when <code>add=FALSE</code>. The default <code>expand=c(0.04, 0.04)</code> mimics
the R base plot default which adds 4 percent total, therefore 2 percent
to each side of the visible range.</p></dd>


<dt>transFactor</dt>
<dd><p><code>numeric</code> value used by the default <code>transformation</code>
function, which effectively scales the density of points to
a reasonable visible distribution. This argument is a convenience
method to avoid having to type out the full <code>transformation</code> function.</p></dd>


<dt>transformation</dt>
<dd><p><code>function</code> which converts point density to a number,
typically related to square root or cube root transformation. Note
that the default uses <code>transFactor</code> but if a custom function is
supplied, it will not use <code>transFactor</code> unless specified.</p></dd>


<dt>xlim</dt>
<dd><p><code>numeric</code> x-axis range, or <code>NULL</code> to use the data range.</p></dd>


<dt>ylim</dt>
<dd><p><code>numeric</code> y-axis range, or <code>NULL</code> to use the data range.</p></dd>


<dt>xlab, ylab</dt>
<dd><p><code>character</code> labels for x- and y-axis, respectively.</p></dd>


<dt>nrpoints</dt>
<dd><p><code>integer</code> number of outlier datapoints to display,
as defined by <code><a href="https://rdrr.io/r/graphics/smoothScatter.html" class="external-link">graphics::smoothScatter()</a></code>, however the default here
is <code>nrpoints=0</code> to avoid additional clutter in the output,
and because the default arguments <code>bwpi</code>, <code>binpi</code> usually indicate all
individual points.</p></dd>


<dt>colramp</dt>
<dd><p>any input recognized by <code><a href="getColorRamp.html">getColorRamp()</a></code>:</p><ul><li><p><code>character</code> vector with multiple colors</p></li>
<li><p><code>character</code> string length 1, with valid R color used to create
a linear color gradient</p></li>
<li><p><code>character</code> name of a known color gradient from <code>RColorBrewer</code>
or <code>viridis</code></p></li>
<li><p><code>function</code> that itself produces vector of colors,
in the form <code>function(n)</code> where <code>n</code> defines the number of colors.</p></li>
</ul></dd>


<dt>col</dt>
<dd><p><code>character</code> string with R color used when <code>nrpoints</code> is
non-zero, this color defines the color of those points.</p></dd>


<dt>doTest</dt>
<dd><p><code>logical</code> indicating whether to create a visual set of test
plots to demonstrate the utility of this function.</p></dd>


<dt>fillBackground</dt>
<dd><p><code>logical</code> indicating whether to fill the
background of the plot panel with the first color in <code>colramp</code>.
The default <code>fillBackground=TRUE</code> is useful since the plot panel
may be slightly wider than the range of data being displayed, and
when the first color in <code>colramp</code> is not the same as the plot device
background color.
Run a test using:
<code>plotSmoothScatter(doTest=TRUE, fillBackground=FALSE, colramp="viridis")</code>
and compare with:
<code>plotSmoothScatter(doTest=TRUE, colramp="viridis")</code></p></dd>


<dt>naAction</dt>
<dd><p><code>character</code> string indicating how to handle NA values,
typically when x is NA and y is not NA, or vice versa. valid values:</p><dl><dt>"remove"</dt>
<dd><p>ignore any points where either x or y are NA</p></dd>

<dt>"floor0"</dt>
<dd><p>change any NA values to zero 0 for either x or y</p></dd>

<dt>"floor1"</dt>
<dd><p>change any NA values to one 1 for either x or y</p></dd>


</dl><p>The latter two options are useful when the desired plot should indicate
the presence of an NA value in either x or y, while also indicating the
the corresponding non-NA value in the opposing axis. The driving use
was plotting gene fold changes from two experiments, where the two
experiments may not have measured the same genes.</p></dd>


<dt>xaxt</dt>
<dd><p><code>character</code> value compatible with par(xaxt), used to control
the x-axis range, similar to its use in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> generic functions.</p></dd>


<dt>yaxt</dt>
<dd><p><code>character</code> value compatible with par(yaxt), used to control
the y-axis range, similar to its use in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> generic functions.</p></dd>


<dt>add</dt>
<dd><p><code>logical</code> whether to add to an existing active R plot, or create
a new plot window.</p></dd>


<dt>asp</dt>
<dd><p><code>numeric</code> with optional aspect ratio, as described in
<code><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">graphics::plot.window()</a></code>, where <code>asp=1</code> defines x- and y-axis
coordinate ranges such that distances between points are rendered
accurately. One data unit on the y-axis is equal in length to
<code>asp</code> multiplied by one data unit on the x-axis.
Notes:</p><ul><li><p>When <code>add=TRUE</code>, the value <code>asp</code> is ignored, because
the existing plot device is re-used.</p></li>
<li><p>When <code>add=FALSE</code> and <code>asp</code> is defined with <code>numeric</code> value,
a new plot device is opened using <code><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">plot.window()</a></code>, and the <code>xlim</code>
and <code>ylim</code> values are passed to that function. As a result the
<code>par("usr")</code> values are used to define <code>xlim</code> and <code>ylim</code> for the
purpose of determining visible points, relevant to <code>applyRangeCeiling</code>.</p></li>
</ul></dd>


<dt>applyRangeCeiling</dt>
<dd><p><code>logical</code> indicating how to handle points outside
the visible plot range. Valid values:</p><dl><dt>TRUE</dt>
<dd><p>Points outside the viewing area are fixed to the
plot boundaries, in order to represent that there are additional
points outside the boundary. This setting is recommended when
the reasonable viewing area is smaller than the actual data,
for example to be consistent across plot panels, but where
you want to indicate that points may be outside the range.</p></dd>

<dt>FALSE</dt>
<dd><p>Points outside the viewing area is not displayed,
with no special visual indication. This setting is useful when
data may contain a large number of points at <code>c(0, 0)</code> and the
density overwhelms the detail in the rest of the plot. In that
case setting <code>xlim=c(1e-10, 10)</code> and <code>applyRangeCeiling=FALSE</code>
would obscure these points.</p></dd>


</dl></dd>


<dt>useRaster</dt>
<dd><p><code>logical</code> indicating whether to produce plots using the
<code><a href="https://rdrr.io/r/graphics/rasterImage.html" class="external-link">graphics::rasterImage()</a></code> function which produces a plot
raster image offline then scales this image to visible plot space.
This technique has two benefits:</p><ol><li><p>It produces substantially faster plot output.</p></li>
<li><p>Output contains substantially fewer plot objects, which results
in much smaller file sizes when saving in PDF or SVG format.</p></li>
</ol></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt>...</dt>
<dd><p>additional arguments are passed to called functions,
including <code><a href="getColorRamp.html">getColorRamp()</a></code>, <code><a href="nullPlot.html">nullPlot()</a></code>, <code><a href="smoothScatterJam.html">smoothScatterJam()</a></code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function intends to make several potentially customizable
features of <code><a href="https://rdrr.io/r/graphics/smoothScatter.html" class="external-link">graphics::smoothScatter()</a></code> plots much easier
to customize. For example bandwidthN allows defining the number of
bandwidth steps used by the kernel density function, and importantly
bases the number of steps on the visible plot window, and not the range
of data, which can differ substantially. The <code>nbin</code> argument is related,
but is used to define the level of detail used in the image function,
which when plotting numerous smaller panels, can be useful to reduce
unnecessary visual details.</p>
<p>This function also by default produces a raster image plot
with <code>useRaster=TRUE</code>, which adjusts the x- and y-bandwidth to
produce visually round density even when the x- and y-ranges
are very different.</p>
<p>Comments:</p><ul><li><p><code>asp=1</code> will define an aspect ratio 1, meaning the x-axis and y-axis
units will be the same physical size in the output device.
When this is true, and <code>fillBackground=TRUE</code> the <code>xlim</code> and <code>ylim</code>
values follow logic for <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default()</a></code> and <code><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">plot.window()</a></code> such that
each axis will include at least the <code>xlim</code> and <code>ylim</code> ranges, with
additional range included in order to maintain the plot aspect ratio.</p></li>
<li><p>When <code>asp</code>, and any of <code>xlim</code> or <code>ylim</code>, are defined, the data will
be "cropped" to respective <code>xlim</code> and <code>ylim</code> values as relevant,
after which the plot is drawn with the appropriate plot aspect ratio.
When <code>applyRangeCeiling=TRUE</code>, points outside the fixed <code>xlim</code> and <code>ylim</code>
range are fixed to the edge of the range, after which the plot is drawn
with the requested plot aspect ratio. It is recommended not to define
<code>xlim</code> and <code>ylim</code> when also defining <code>asp</code>.</p></li>
<li><p>When <code>add=TRUE</code> the <code>xlim</code> and <code>ylim</code> values are already defined
by the plot device. It is recommended not to define <code>xlim</code> and <code>ylim</code>
when <code>add=TRUE</code>.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other jam plot functions: 
<code><a href="adjustAxisLabelMargins.html">adjustAxisLabelMargins</a>()</code>,
<code><a href="coordPresets.html">coordPresets</a>()</code>,
<code><a href="decideMfrow.html">decideMfrow</a>()</code>,
<code><a href="drawLabels.html">drawLabels</a>()</code>,
<code><a href="getPlotAspect.html">getPlotAspect</a>()</code>,
<code><a href="groupedAxis.html">groupedAxis</a>()</code>,
<code><a href="imageByColors.html">imageByColors</a>()</code>,
<code><a href="imageDefault.html">imageDefault</a>()</code>,
<code><a href="minorLogTicksAxis.html">minorLogTicksAxis</a>()</code>,
<code><a href="nullPlot.html">nullPlot</a>()</code>,
<code><a href="plotPolygonDensity.html">plotPolygonDensity</a>()</code>,
<code><a href="plotRidges.html">plotRidges</a>()</code>,
<code><a href="shadowText_options.html">shadowText_options</a>()</code>,
<code><a href="shadowText.html">shadowText</a>()</code>,
<code><a href="showColors.html">showColors</a>()</code>,
<code><a href="smoothScatterJam.html">smoothScatterJam</a>()</code>,
<code><a href="sqrtAxis.html">sqrtAxis</a>()</code>,
<code><a href="usrBox.html">usrBox</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># doTest=TRUE invisibly returns the test data</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">plotSmoothScatter</span><span class="op">(</span>doTest<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="plotSmoothScatter-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># so it can be plotted again with different settings</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"column_1"</span>, <span class="st">"column_2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotSmoothScatter</span><span class="op">(</span><span class="va">x</span>, colramp<span class="op">=</span><span class="st">"inferno"</span><span class="op">)</span>;</span></span>
<span class="r-plt img"><img src="plotSmoothScatter-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

