<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Xlsx Conditional formatting — applyXlsxConditionalFormat • jamba</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Xlsx Conditional formatting — applyXlsxConditionalFormat"><meta name="description" content="Xlsx Conditional formatting"><meta property="og:description" content="Xlsx Conditional formatting"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">jamba</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/jamba-vignette.html">Jamba Overview</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jmw86069/jamba/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Xlsx Conditional formatting</h1>
      <small class="dont-index">Source: <a href="https://github.com/jmw86069/jamba/blob/HEAD/R/jamba-export.r" class="external-link"><code>R/jamba-export.r</code></a></small>
      <div class="d-none name"><code>applyXlsxConditionalFormat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Xlsx Conditional formatting</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">applyXlsxConditionalFormat</span><span class="op">(</span></span>
<span>  <span class="va">xlsxFile</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  fcColumns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fcGrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fcStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4F81BD"</span>, <span class="st">"#EEECE1"</span>, <span class="st">"#C0504D"</span><span class="op">)</span>,</span>
<span>  fcRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  fcType <span class="op">=</span> <span class="st">"colourScale"</span>,</span>
<span>  lfcColumns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lfcGrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lfcStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4F81BD"</span>, <span class="st">"#EEECE1"</span>, <span class="st">"#C0504D"</span><span class="op">)</span>,</span>
<span>  lfcRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  lfcType <span class="op">=</span> <span class="st">"colourScale"</span>,</span>
<span>  hitColumns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hitGrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hitStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4F81BD"</span>, <span class="st">"#EEECE1"</span>, <span class="st">"#C0504D"</span><span class="op">)</span>,</span>
<span>  hitRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">0</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  hitType <span class="op">=</span> <span class="st">"colourScale"</span>,</span>
<span>  intColumns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intGrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#EEECE1"</span>, <span class="st">"#FDC99B"</span>, <span class="st">"#F77F30"</span><span class="op">)</span>,</span>
<span>  intRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">10000</span><span class="op">)</span>,</span>
<span>  intType <span class="op">=</span> <span class="st">"colourScale"</span>,</span>
<span>  numColumns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  numGrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  numStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#F2F0F7"</span>, <span class="st">"#B4B1D4"</span>, <span class="st">"#938EC2"</span><span class="op">)</span>,</span>
<span>  numRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  numType <span class="op">=</span> <span class="st">"colourScale"</span>,</span>
<span>  pvalueColumns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pvalueGrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pvalueStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#F77F30"</span>, <span class="st">"#FDC99B"</span>, <span class="st">"#EEECE1"</span><span class="op">)</span>,</span>
<span>  pvalueRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  pvalueType <span class="op">=</span> <span class="st">"colourScale"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  startRow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-xlsxfile">xlsxFile<a class="anchor" aria-label="anchor" href="#arg-xlsxfile"></a></dt>
<dd><p><code>character</code> filename to a file with ".xlsx" extension,
or <code>Workbook</code> object defined in the <code>openxlsx</code> package. When
<code>xlsxFile</code> is a <code>Workbook</code> the output is not saved to a file.</p></dd>


<dt id="arg-sheet">sheet<a class="anchor" aria-label="anchor" href="#arg-sheet"></a></dt>
<dd><p>integer or character, either the worksheet number, in order
or character worksheet name. This vector can contain multiple values,
which will cause conditional formatting to be applied to each
worksheet in the order given.</p></dd>


<dt id="arg-fccolumns-lfccolumns-hitcolumns-intcolumns-numcolumns-pvaluecolumns">fcColumns, lfcColumns, hitColumns, intColumns, numColumns, pvalueColumns<a class="anchor" aria-label="anchor" href="#arg-fccolumns-lfccolumns-hitcolumns-intcolumns-numcolumns-pvaluecolumns"></a></dt>
<dd><p>integer column indices, or character colnames indicating which columns
are to be treated as each of the various column types.</p></dd>


<dt id="arg-fcgrep-lfcgrep-hitgrep-intgrep-numgrep-pvaluegrep">fcGrep, lfcGrep, hitGrep, intGrep, numGrep, pvalueGrep<a class="anchor" aria-label="anchor" href="#arg-fcgrep-lfcgrep-hitgrep-intgrep-numgrep-pvaluegrep"></a></dt>
<dd><p>optional character vector which is used by <code><a href="provigrep.html">provigrep</a></code> to
colnames(x). This process may be more convenient to apply formatting
to known colname character patterns, rather than supplying exact column
indices or colnames.</p></dd>


<dt id="arg-fcstyle-lfcstyle-hitstyle-intstyle-numstyle-pvaluestyle">fcStyle, lfcStyle, hitStyle, intStyle, numStyle, pvalueStyle<a class="anchor" aria-label="anchor" href="#arg-fcstyle-lfcstyle-hitstyle-intstyle-numstyle-pvaluestyle"></a></dt>
<dd><p>color vector of length=3, corresponding to the numeric thresholds
defined by the corresponding Rules.</p></dd>


<dt id="arg-fcrule-lfcrule-hitrule-intrule-numrule-pvaluerule">fcRule, lfcRule, hitRule, intRule, numRule, pvalueRule<a class="anchor" aria-label="anchor" href="#arg-fcrule-lfcrule-hitrule-intrule-numrule-pvaluerule"></a></dt>
<dd><p>numeric vector of length=3, used to define three numeric thresholds
for color gradients to be applied.</p></dd>


<dt id="arg-fctype-lfctype-hittype-inttype-numtype-pvaluetype">fcType, lfcType, hitType, intType, numType, pvalueType<a class="anchor" aria-label="anchor" href="#arg-fctype-lfctype-hittype-inttype-numtype-pvaluetype"></a></dt>
<dd><p>character string indicating the type of conditional rule to apply,
which in most cases should be "colourScale" which allows three numeric
thresholds, and three corresponding colors. For other allowed values,
see <code><a href="https://rdrr.io/pkg/openxlsx/man/conditionalFormatting.html" class="external-link">openxlsx::conditionalFormatting()</a></code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical indicating whether to print verbose output.</p></dd>


<dt id="arg-startrow">startRow<a class="anchor" aria-label="anchor" href="#arg-startrow"></a></dt>
<dd><p>integer indicating which row to begin applying conditional
formatting. In most cases startRow=2, which allows one row for column
headers. However, if there are multiple header rows, startRow should be
1 more than the number of header rows.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>logical indicating whether the original Excel files will
be replaced with the new one, or whether a new file will be created.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters are ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>Workbook</code> object as defined by the <code>openxlsx</code> package
is returned invisibly with <code><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible()</a></code>. This <code>Workbook</code>
can be used in argument <code>wb</code> to provide a speed boost when
saving multiple sheets to the same file.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is a convenient wrapper for applying conditional formatting
to Excel xlsx worksheets, with reasonable settings for commonly used
data types.</p>
<p>Note that this function does not apply cell formatting, such as numeric
formatting as displayed in Excel.</p>
<p>A description of column types follows:</p><dl><dt>"fc"</dt>
<dd><p>Fold change, typically positive and negative values,
which are formatted to show one decimal place, and use commas
to separate thousands places, e.g. 1,020.1. Colors are applied
with a neutral midpoint, coloring values which are above and
below zero.</p></dd>

<dt>"lfc"</dt>
<dd><p>log fold change, typically positive and negative values,
which are formatted to show one decimal place, and use commas
to separate thousands places, e.g. 12.1. Colors are applied
with a neutral midpoint, coloring values which are above and
below zero. Log fold changes have slightly different color
thresholds than fold changes.</p></dd>

<dt>"hit"</dt>
<dd><p>Hit columns, often just values like <code>c(-1,0,1)</code>,
but which could be fold changes for statistical hits for example.
They are formatted to show one decimal place, and use commas
to separate thousands places, e.g. 1.5. Colors are applied
with a neutral midpoint, coloring values which are above and
below zero, typically with a fairly low threshold.</p></dd>

<dt>"int"</dt>
<dd><p>Integer columns, which are formatted to hide decimal
place values even if present, which can help clean up visible
tabular data. They are formatted to use commas
to separate thousands places, e.g. 1,020. Colors are applied
with a baseline of zero, intended for highlighting two thresholds
of values above zero.</p></dd>

<dt>"num"</dt>
<dd><p>Numeric columns, which are formatted to display 2 decimal
places, and to use commas to separate thousands places,
e.g. 1,020.1. Colors are applied
with a baseline of zero, intended for highlighting two thresholds
of values above zero.</p></dd>

<dt>"pvalue"</dt>
<dd><p>P-value columns, which are formatted to display
scientific notation always, for consistency, with two decimal
places, e.g. 1.02e-02. Colors are applied starting at white for
P-value of 1 (non-significant) and becoming more red as the
P-value approaches 0.01, then 0.0001.</p></dd>


</dl><p>For each column type, one can describe the column using integer indices,
or colnames, or optionally use the Grep parameters. The Grep parameters
are intended for pattern matching, and may contain a vector of grep patterns
which are used by <code><a href="provigrep.html">provigrep</a></code> to match to colnames. The Grep
method is particularly useful when applying conditional formatting for
multiple worksheets in the same .xlsx file, where the colnames are not
identical in each worksheet.</p>
<p>Each column type has an associated 3-threshold rule, and three associated
colors. In order to apply different thresholds, one would need to call
this function multiple times, specifying different subsets of columns
corresponding to each set of thresholds. The same process is required
in order to apply different color gradients to different columns. Note
that styles are by default "stacked", which
maintains font and cell border styles without removing them. However, it
this "stacking" means that applying two rules to the same cell will not
work, since only the first rule will be applied by Microsoft Excel.
Interestingly, if multiple conditional rules are applied to the same
cell, they will be visible in order inside the Microsoft Excel
application.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other jam export functions:
<code><a href="applyXlsxCategoricalFormat.html">applyXlsxCategoricalFormat</a>()</code>,
<code><a href="readOpenxlsx.html">readOpenxlsx</a>()</code>,
<code><a href="set_xlsx_colwidths.html">set_xlsx_colwidths</a>()</code>,
<code><a href="set_xlsx_rowheights.html">set_xlsx_rowheights</a>()</code>,
<code><a href="writeOpenxlsx.html">writeOpenxlsx</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>   <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a<span class="op">=</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, b<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>   <span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="writeOpenxlsx.html">writeOpenxlsx</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">df</span>,</span></span>
<span class="r-in"><span>      file<span class="op">=</span><span class="st">"jamba_test.xlsx"</span>,</span></span>
<span class="r-in"><span>      sheetName<span class="op">=</span><span class="st">"test_jamba"</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="fu">applyXlsxConditionalFormat</span><span class="op">(</span></span></span>
<span class="r-in"><span>      xlsxFile<span class="op">=</span><span class="st">"jamba_test.xlsx"</span>,</span></span>
<span class="r-in"><span>      sheet<span class="op">=</span><span class="st">"test_jamba"</span>,</span></span>
<span class="r-in"><span>      intColumns<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>      intRule<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      intStyle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FFFFFF"</span>, <span class="st">"#1E90FF"</span>, <span class="st">"#9932CC"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

