<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Xlsx Conditional formatting — applyXlsxConditionalFormat • jamba</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Xlsx Conditional formatting — applyXlsxConditionalFormat"><meta property="og:description" content="Xlsx Conditional formatting"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jamba</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.69.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jamba-vignette.html">Jamba Overview</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/jmw86069/jamba/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Xlsx Conditional formatting</h1>
    <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamba/blob/HEAD/R/jamba-export.r" class="external-link"><code>R/jamba-export.r</code></a></small>
    <div class="hidden name"><code>applyXlsxConditionalFormat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Xlsx Conditional formatting</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">applyXlsxConditionalFormat</span><span class="op">(</span>
  <span class="va">xlsxFile</span>,
  sheet <span class="op">=</span> <span class="fl">1</span>,
  fcColumns <span class="op">=</span> <span class="cn">NULL</span>,
  fcGrep <span class="op">=</span> <span class="cn">NULL</span>,
  fcStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4F81BD"</span>, <span class="st">"#EEECE1"</span>, <span class="st">"#C0504D"</span><span class="op">)</span>,
  fcRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>,
  fcType <span class="op">=</span> <span class="st">"colourScale"</span>,
  lfcColumns <span class="op">=</span> <span class="cn">NULL</span>,
  lfcGrep <span class="op">=</span> <span class="cn">NULL</span>,
  lfcStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4F81BD"</span>, <span class="st">"#EEECE1"</span>, <span class="st">"#C0504D"</span><span class="op">)</span>,
  lfcRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,
  lfcType <span class="op">=</span> <span class="st">"colourScale"</span>,
  hitColumns <span class="op">=</span> <span class="cn">NULL</span>,
  hitGrep <span class="op">=</span> <span class="cn">NULL</span>,
  hitStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4F81BD"</span>, <span class="st">"#EEECE1"</span>, <span class="st">"#C0504D"</span><span class="op">)</span>,
  hitRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">0</span>, <span class="fl">1.5</span><span class="op">)</span>,
  hitType <span class="op">=</span> <span class="st">"colourScale"</span>,
  intColumns <span class="op">=</span> <span class="cn">NULL</span>,
  intGrep <span class="op">=</span> <span class="cn">NULL</span>,
  intStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#EEECE1"</span>, <span class="st">"#FDC99B"</span>, <span class="st">"#F77F30"</span><span class="op">)</span>,
  intRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">10000</span><span class="op">)</span>,
  intType <span class="op">=</span> <span class="st">"colourScale"</span>,
  numColumns <span class="op">=</span> <span class="cn">NULL</span>,
  numGrep <span class="op">=</span> <span class="cn">NULL</span>,
  numStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#F2F0F7"</span>, <span class="st">"#B4B1D4"</span>, <span class="st">"#938EC2"</span><span class="op">)</span>,
  numRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>,
  numType <span class="op">=</span> <span class="st">"colourScale"</span>,
  pvalueColumns <span class="op">=</span> <span class="cn">NULL</span>,
  pvalueGrep <span class="op">=</span> <span class="cn">NULL</span>,
  pvalueStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#F77F30"</span>, <span class="st">"#FDC99B"</span>, <span class="st">"#EEECE1"</span><span class="op">)</span>,
  pvalueRule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span><span class="op">)</span>,
  pvalueType <span class="op">=</span> <span class="st">"colourScale"</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  startRow <span class="op">=</span> <span class="fl">2</span>,
  overwrite <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>

    <div id="ref-sections">
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>xlsxFile</dt>
<dd><p>character filename to a file with ".xlsx" extension.</p></dd>
<dt>sheet</dt>
<dd><p>integer or character, either the worksheet number, in order
or character worksheet name. This vector can contain multiple values,
which will cause conditional formatting to be applied to each
worksheet in the order given.</p></dd>
<dt>fcColumns, lfcColumns, hitColumns, intColumns, numColumns, pvalueColumns</dt>
<dd><p>integer column indices, or character colnames indicating which columns
are to be treated as each of the various column types.</p></dd>
<dt>fcGrep, lfcGrep, hitGrep, intGrep, numGrep, pvalueGrep</dt>
<dd><p>optional character vector which is used by <code><a href="provigrep.html">provigrep</a></code> to
colnames(x). This process may be more convenient to apply formatting
to known colname character patterns, rather than supplying exact column
indices or colnames.</p></dd>
<dt>fcStyle, lfcStyle, hitStyle, intStyle, numStyle, pvalueStyle</dt>
<dd><p>color vector of length=3, corresponding to the numeric thresholds
defined by the corresponding Rules.</p></dd>
<dt>fcRule, lfcRule, hitRule, intRule, numRule, pvalueRule</dt>
<dd><p>numeric vector of length=3, used to define three numeric thresholds
for color gradients to be applied.</p></dd>
<dt>fcType, lfcType, hitType, intType, numType, pvalueType</dt>
<dd><p>character string indicating the type of conditional rule to apply,
which in most cases should be "colourScale" which allows three numeric
thresholds, and three corresponding colors. For other allowed values,
see <code><a href="https://rdrr.io/pkg/openxlsx/man/conditionalFormatting.html" class="external-link">openxlsx::conditionalFormatting</a></code>.</p></dd>
<dt>verbose</dt>
<dd><p>logical indicating whether to print verbose output.</p></dd>
<dt>startRow</dt>
<dd><p>integer indicating which row to begin applying conditional
formatting. In most cases startRow=2, which allows one row for column
headers. However, if there are multiple header rows, startRow should be
1 more than the number of header rows.</p></dd>
<dt>overwrite</dt>
<dd><p>logical indicating whether the original Excel files will
be replaced with the new one, or whether a new file will be created.</p></dd>
<dt>...</dt>
<dd><p>additional parameters are ignored.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function is a convenient wrapper for applying conditional formatting
to Excel xlsx worksheets, with reasonable settings for commonly used
data types.</p>
<p>Note that this function does not apply cell formatting, such as numeric
formatting as displayed in Excel.</p>
<p>A description of column types follows:</p><dl><dt>"fc"</dt>
<dd><p>Fold change, typically positive and negative values,
which are formatted to show one decimal place, and use commas
to separate thousands places, e.g. 1,020.1. Colors are applied
with a neutral midpoint, coloring values which are above and
below zero.</p></dd>

<dt>"lfc"</dt>
<dd><p>log fold change, typically positive and negative values,
which are formatted to show one decimal place, and use commas
to separate thousands places, e.g. 12.1. Colors are applied
with a neutral midpoint, coloring values which are above and
below zero. Log fold changes have slightly different color
thresholds than fold changes.</p></dd>

<dt>"hit"</dt>
<dd><p>Hit columns, often just values like <code>c(-1,0,1)</code>,
but which could be fold changes for statistical hits for example.
They are formatted to show one decimal place, and use commas
to separate thousands places, e.g. 1.5. Colors are applied
with a neutral midpoint, coloring values which are above and
below zero, typically with a fairly low threshold.</p></dd>

<dt>"int"</dt>
<dd><p>Integer columns, which are formatted to hide decimal
place values even if present, which can help clean up visible
tabular data. They are formatted to use commas
to separate thousands places, e.g. 1,020. Colors are applied
with a baseline of zero, intended for highlighting two thresholds
of values above zero.</p></dd>

<dt>"num"</dt>
<dd><p>Numeric columns, which are formatted to display 2 decimal
places, and to use commas to separate thousands places,
e.g. 1,020.1. Colors are applied
with a baseline of zero, intended for highlighting two thresholds
of values above zero.</p></dd>

<dt>"pvalue"</dt>
<dd><p>P-value columns, which are formatted to display
scientific notation always, for consistency, with two decimal
places, e.g. 1.02e-02. Colors are applied starting at white for
P-value of 1 (non-significant) and becoming more red as the
P-value approaches 0.01, then 0.0001.</p></dd>


</dl><p>For each column type, one can describe the column using integer indices,
or colnames, or optionally use the Grep parameters. The Grep parameters
are intended for pattern matching, and may contain a vector of grep patterns
which are used by <code><a href="provigrep.html">provigrep</a></code> to match to colnames. The Grep
method is particularly useful when applying conditional formatting for
multiple worksheets in the same .xlsx file, where the colnames are not
identical in each worksheet.</p>
<p>Each column type has an associated 3-threshold rule, and three associated
colors. In order to apply different thresholds, one would need to call
this function multiple times, specifying different subsets of columns
corresponding to each set of thresholds. The same process is required
in order to apply different color gradients to different columns. Note
that styles are by default "stacked", which
maintains font and cell border styles without removing them. However, it
this "stacking" means that applying two rules to the same cell will not
work, since only the first rule will be applied by Microsoft Excel.
Interestingly, if multiple conditional rules are applied to the same
cell, they will be visible in order inside the Microsoft Excel
application.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other jam export functions: 
<code><a href="applyXlsxCategoricalFormat.html">applyXlsxCategoricalFormat</a>()</code>,
<code><a href="readOpenxlsx.html">readOpenxlsx</a>()</code>,
<code><a href="set_xlsx_colwidths.html">set_xlsx_colwidths</a>()</code>,
<code><a href="set_xlsx_rowheights.html">set_xlsx_rowheights</a>()</code>,
<code><a href="writeOpenxlsx.html">writeOpenxlsx</a>()</code></p></div>
    </div>
    </div>

    <div id="examples">
    <h2>Examples</h2>
    <div class="ref-examples sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">   <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a<span class="op">=</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, b<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>;</span>
<span class="r-in">   <span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="writeOpenxlsx.html">writeOpenxlsx</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">df</span>,</span>
<span class="r-in">      file<span class="op">=</span><span class="st">"jamba_test.xlsx"</span>,</span>
<span class="r-in">      sheetName<span class="op">=</span><span class="st">"test_jamba"</span><span class="op">)</span>;</span>
<span class="r-in"></span>
<span class="r-in">   <span class="fu">applyXlsxConditionalFormat</span><span class="op">(</span></span>
<span class="r-in">      xlsxFile<span class="op">=</span><span class="st">"jamba_test.xlsx"</span>,</span>
<span class="r-in">      sheet<span class="op">=</span><span class="st">"test_jamba"</span>,</span>
<span class="r-in">      intColumns<span class="op">=</span><span class="fl">2</span>,</span>
<span class="r-in">      intRule<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span class="r-in">      intStyle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#FFFFFF"</span>, <span class="st">"#1E90FF"</span>, <span class="st">"#9932CC"</span><span class="op">)</span></span>
<span class="r-in">   <span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

